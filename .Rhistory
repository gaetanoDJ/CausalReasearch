gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "sid", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
atts <- att_gt(yname = "rape_pc", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "sid", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
atts <- att_gt(yname = "rape_pc", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "stname", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
CleanUP$stname <- as.numeric(stname)
CleanUP$stname <- as.numeric(CleanUP$stnamestname)
View(CleanUP)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "stname", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
CleanUP <- as.numeric(CleanUP$stnamestname)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
panel = TRUE) # whether the data is panel or repeated cross-sectional
View(UCRQuarter)
View(UCRQuarter)
UCRTEST <- collapse::collap(UCRQuarter, ~ stname + year)
View(UCRTEST)
CleanUPWork <- collapse(CleanUP, ~ stname + year)
View(CleanUP)
View(CleanUPWork)
CleanUPWork <- collapse(CleanUP, ~ stname + year + treated)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
View(CleanUPWork)
CleanUP$treated <- ifelse(CleanUP$treated>0,1,0)
View(CleanUPWork)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
CleanUPWork$treated <- ifelse(CleanUP$treated>0,1,0)
CleanUPWork$treated <- ifelse(CleanUPWork$treated>0,1,0)
View(CleanUPWork)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
CleanUPWork
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
View(CleanUPWork)
CleanUPWork$treated <- ifelse(CleanUPWork$treated>0,1,0)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUP, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
panel = TRUE) # whether the data is panel or repeated cross-sectional
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
testing <-  att_gt(yname = "rape",
gname = "year",
idname = "statefip",
tname = "year",
xformla = ~1,
data = CleanUPWork,
)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "notyettreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
summary(atts)
ggdid(atts)
summary(agg_effects_es)
agg_effects_es <- aggte(atts, type = "dynamic")
summary(agg_effects_es)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = ~1, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "notyettreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = ~1, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "reg", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "notyettreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = ~1, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "notyettreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
summary(atts)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = ~1, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
summary(atts)
castle <- data.frame(read.dta13('https://github.com/scunning1975/mixtape/raw/master/castle.dta'))
View(castle)
castle <- data.frame(read.dta13('https://github.com/scunning1975/mixtape/raw/master/castle.dta'))
View(castle)
castle$effyear[is.na(castle$effyear)] <- 0
castle$effyear[is.na(castle$effyear)] <- 0
atts <- att_gt(yname = "l_homicide", # LHS variable
tname = "year", # time variable
idname = "sid", # id variable
gname = "effyear", # first treatment period variable
data = castle, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE, # if TRUE, print detailed results
clustervars = "sid", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
atts <- att_gt(yname = "rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = ~1, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = FALSE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
atts <- att_gt(yname = "rape_pc", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = FALSE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
summary(atts)
castle$l_homicide
View(castle)
log(7.59)
CleanUPWork %>%
select(rape) %>%
mutate(
l_rape = log(rape)
)
View(CleanUPWork)
atts <- att_gt(yname = "l_rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = FALSE) # whether the data is panel or repeated cross-sectional
CleanUPWork$l_rape <- CleanUPWork %>%
select(rape) %>%
mutate(
l_rape = log(rape)
)
View(CleanUPWork)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
CleanUPWork$treated <- ifelse(CleanUPWork$treated>0,1,0)
View(CleanUPWork)
CleanUPWork %>%
select(rape) %>%
mutate(
l_rape = log(rape)
)
View(CleanUPWork)
CleanUPWork$l_rape %>%
select(rape) %>%
mutate(
l_rape = log(rape)
)
CleanUPWork$l_rape = CleanUPWork %>%
select(rape) %>%
mutate(
l_rape = log(rape)
)
View(CleanUPWork)
CleanUPWork <- collap(CleanUP, ~ stname + year)
CleanUPWork$treated <- ifelse(CleanUPWork$treated>0,1,0)
CleanUPWork$l_rape = CleanUPWork %>%
mutate(
l_rape = log(rape)
)
View(CleanUPWork)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
CleanUPWork$treated <- ifelse(CleanUPWork$treated>0,1,0)
CleanUPWork$l_rape = CleanUPWork %>%
select(rape) %>%
mutate(
l_rape = log(rape)
)
atts <- att_gt(yname = "l_rape.l_rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = FALSE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
CleanUPWork$treated <- ifelse(CleanUPWork$treated>0,1,0)
CleanUPWork$l_rape <- log(CleanUPWork$rape)
CleanUPWork
View(CleanUPWork)
atts <- att_gt(yname = "l_rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = FALSE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
atts <- att_gt(yname = "murder_pc", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = FALSE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
atts <- att_gt(yname = "l_rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
agg_effects <- aggte(atts, type = "group", na.rm = TRUE)
summary(agg_effects)
atts <- att_gt(yname = "l_rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group", na.rm = TRUE)
summary(agg_effects)
atts <- att_gt(yname = "l_rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
example_attgt_reg <- att_gt(yname = "l_rape",
gname = "First.Treat",
idname = "statefip",
tname = "year",
xformla = ~1,
data = CleanUPWork,
est_method = "reg"
)
summary(example_attgt_reg)
agg_effects <- aggte(example_attgt_reg, type = "group", na.rm = TRUE)
summary(agg_effects)
CleanUP <- read_excel("G:/Causal Inference/Data/CleanUP.xlsx")
CleanUPWork <- collap(CleanUP, ~ stname + year)
CleanUPWork$treated <- ifelse(CleanUPWork$treated>0,1,0)
CleanUPWork$l_rape <- log(CleanUPWork$rape)
atts <- att_gt(yname = "l_rape", # LHS variable
tname = "year", # time variable
idname = "statefip", # id variable
gname = "First.Treat", # first treatment period variable
data = CleanUPWork, # data
xformla = NULL, # no covariates
#xformla = ~ l_police, # with covariates
est_method = "dr", # "dr" is doubly robust. "ipw" is inverse probability weighting. "reg" is regression
control_group = "nevertreated", # set the comparison group which is either "nevertreated" or "notyettreated"
bstrap = TRUE, # if TRUE compute bootstrapped SE
biters = 1000, # number of bootstrap iterations
print_details = FALSE,
clustervars = "statefip", # cluster level
panel = TRUE) # whether the data is panel or repeated cross-sectional
agg_effects <- aggte(atts, type = "group")
summary(agg_effects)
agg_effects <- aggte(atts, type = "group", na.rm = TRUE)
summary(agg_effects)
